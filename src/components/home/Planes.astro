---
import { titles as data } from '../../js/titles';
import { planes } from '../../js/planes'
import Check from '../icons/Check.astro'
import TitleSection from '../common/TitleSection.astro';
const images = [
   '/christmas/chimney.png',
   '/christmas/gingerbread.png',
   '/christmas/christmas-present.png',
];
---
<section 
  id="planes" class="flex items-center md:px-20 sm:px-10 px-5 justify-center min-h-screen bg-background dark:bg-dark-background scroll-mt-12" aria-label="Sección de planes">
  <div class="max-w-screen-xl mx-auto lg:py-16 py-12 relative z-10">
   <div data-aos="fade-down" data-aos-duration="800">
     <TitleSection title={data.planes.title} titleHeader={data.planes.titleHeader} isCenter={true} />
   </div>
    <div class="mt-8 w-full m-auto grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4">
      {
         planes.map((plan, index) => (
            <a href="/contacto" 
               class={`plan-card relative p-6 lg:p-10 ${index === 2 ? 'sm:col-span-2 xl:col-span-1' : ''} gap-10 bg-background/90 dark:bg-bg-surface rounded-2xl shadow-lg flex flex-col justify-between overflow-hidden transition-all duration-500 border-2 border-primary/20 dark:border-primary/30 cursor-pointer no-underline`}
               data-aos="fade-up" 
               data-aos-duration="800" 
               data-aos-delay={index * 100}>
               
               {/* Badge de descuento */}
               {plan.discount && (
                  <div class="absolute top-4 right-4 bg-primary dark:bg-primary-bright text-white px-3 py-1 rounded-full text-xs font-bold z-20 shadow-lg">
                     -{plan.discount}%
                  </div>
               )}
               
               {/* Efecto de hielo en hover */}
               <div class="ice-effect absolute inset-0 opacity-0 pointer-events-none transition-opacity duration-500"></div>
               
               <div class="flex flex-col gap-6 relative z-10">
                  <header class="flex flex-col gap-2">
                     <h3 class="text-xl dark:text-background font-semibold">{plan.name}</h3>
                     <p class="text-start text-lg lg:text-sm text-primary dark:text-primary-bright">{plan.description}</p>
                  </header>
                  <ul class="flex flex-col w-full gap-2">
                     {
                        plan.features.map((item, index) => (
                           <li class="flex gap-2 items-center justify-self-auto">
                              <Check class="w-5 h-5 lg:w-6 lg:h-6 text-primary dark:text-primary-bright"/>
                              <p class="text-sm dark:text-text-light dark:text-border-input lg:text-base">{item.label}</p>
                           </li>
                        ))
                     }
                  </ul>
               </div>
               <footer class="relative z-10">
                  {plan.discount ? (
                     <div class="flex items-center gap-2">
                        <p class="text-lg text-text-dark dark:text-text-light font-medium text-text-secundary">
                           {plan.currency}{plan.discountedPrice}
                        </p>
                        <p class="text-sm text-text-dark dark:text-text-light/70 line-through opacity-60">
                           {plan.currency}{plan.price}
                        </p>
                     </div>
                  ) : (
                     <p class="text-lg text-text-dark dark:text-text-light font-medium text-text-secundary">
                        {plan.currency ? `${plan.currency}${plan.price}` : plan.price}
                     </p>
                  )}
                  <p class="text-sm text-text-dark dark:text-text-light text-text-secundary">{plan.duration}</p>
               </footer>
               
               <img src={images[index]} alt="" class="plan-image absolute right-0 bottom-0 w-20 h-20 lg:w-26 lg:h-26 hidden md:block transition-transform duration-500 z-10"/>
            </a>
         ))
      }
    </div>
  </div>
</section>

<style>
  .plan-card {
    position: relative;
  }

  /* .plan-card {
    transition: all 0.2s ease;
  } */

  /* Cuando el contenedor tiene hover, atenuar todas las tarjetas */
  .plan-card:hover {
    transform: scale(1.05);
    /* box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); */
    border-color: var(--color-primary);
    z-index: 10;
  }

  /* Atenuar las tarjetas que NO tienen hover cuando alguna tiene hover */
  #planes:has(.plan-card:hover) .plan-card:not(:hover) {
    /* opacity: 0.5; */
    /* filter: blur(2px); */
    transform: scale(0.95);
  }

  /* .plan-card:hover {
    border-color: rgba(var(--primary-rgb, 59, 130, 246), 0.6);
    box-shadow: 0 0 30px rgba(59, 130, 246, 0.3), 
                0 0 60px rgba(59, 130, 246, 0.15),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
    transform: translateY(-4px);
  } */

  /* .ice-effect {
    background: 
      radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 50%),
      radial-gradient(circle at 80% 70%, rgba(147, 197, 253, 0.2) 0%, transparent 50%),
      radial-gradient(circle at 40% 80%, rgba(186, 230, 253, 0.25) 0%, transparent 50%),
      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(147, 197, 253, 0.15) 100%);
    backdrop-filter: blur(2px);
  } */

  .plan-card:hover .ice-effect {
    opacity: 1;
    animation: ice-shimmer 3s ease-in-out infinite;
  }

  .plan-card:hover .plan-image {
    transform: scale(1.1) rotate(5deg);
  }

  @keyframes ice-shimmer {
    0%, 100% {
      background-position: 0% 0%;
    }
    50% {
      background-position: 100% 100%;
    }
  }

  /* Efecto de cristales de hielo en los bordes */
  .plan-card::before {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(45deg, 
      rgba(59, 130, 246, 0.2),
      rgba(147, 197, 253, 0.3),
      rgba(186, 230, 253, 0.2),
      rgba(59, 130, 246, 0.2)
    );
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity 0.5s ease;
  }

  .plan-card:hover::before {
    opacity: 1;
    animation: border-glow 2s ease-in-out infinite;
  }

  @keyframes border-glow {
    0%, 100% {
      filter: brightness(1) hue-rotate(0deg);
    }
    50% {
      filter: brightness(1.2) hue-rotate(10deg);
    }
  }

  /* Partículas de hielo flotantes */
  .plan-card::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 1rem;
    background-image: 
      radial-gradient(circle, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
      radial-gradient(circle, rgba(147, 197, 253, 0.6) 1px, transparent 1px);
    background-size: 50px 50px, 80px 80px;
    background-position: 0 0, 40px 40px;
    opacity: 0;
    transition: opacity 0.5s ease;
    pointer-events: none;
  }

  .plan-card:hover::after {
    opacity: 0.3;
    animation: snow-fall 10s linear infinite;
  }

  @keyframes snow-fall {
    0% {
      background-position: 0 0, 40px 40px;
    }
    100% {
      background-position: 0 100px, 40px 140px;
    }
  }
</style>